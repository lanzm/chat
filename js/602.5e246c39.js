"use strict";(self["webpackChunkmy_chat"]=self["webpackChunkmy_chat"]||[]).push([[602],{8221:function(t,e,o){o.r(e),o.d(e,{default:function(){return f}});var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"section"},[e("el-card",{staticClass:"login-form-layout"},[e("el-form",{ref:"loginForm",attrs:{autoComplete:"on",model:t.loginForm,rules:t.loginRules,"label-position":"left"}},[e("div",{staticStyle:{display:"flex","margin-bottom":"20px"}},[e("div",[e("div",{staticStyle:{"font-size":"20px","line-height":"26px","font-weight":"600"}},[t._v(" 我的 "),e("span",{staticClass:"el-icon-chat-dot-square"})])])]),e("el-form-item",{staticStyle:{"margin-bottom":"16px"},attrs:{prop:"username"}},[e("el-input",{attrs:{name:"username",type:"text",autoComplete:"on",placeholder:"账号"},model:{value:t.loginForm.username,callback:function(e){t.$set(t.loginForm,"username",e)},expression:"loginForm.username"}},[e("span",{attrs:{slot:"prefix"},slot:"prefix"},[e("span",{staticClass:"el-icon-user",staticStyle:{"margin-left":"5px"}})])])],1),e("el-form-item",{staticStyle:{"margin-bottom":"16px"},attrs:{prop:"password"}},[e("el-input",{attrs:{name:"password",type:t.pwdType,autoComplete:"on",placeholder:"请输入密码"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleLogin.apply(null,arguments)}},model:{value:t.loginForm.password,callback:function(e){t.$set(t.loginForm,"password",e)},expression:"loginForm.password"}},[e("span",{attrs:{slot:"prefix"},slot:"prefix"},[e("span",{staticClass:"el-icon-lock",staticStyle:{"margin-left":"5px"}})]),e("span",{attrs:{slot:"suffix"},on:{click:t.showPwd},slot:"suffix"},[t.pwdType?e("span",{staticClass:"el-icon-thumb"}):e("span",{staticClass:"el-icon-view",staticStyle:{color:"#287dff"}})])])],1),e("el-form-item",{attrs:{prop:"code"}},[e("el-row",{attrs:{gutter:10}},[e("el-col",{attrs:{span:16}},[e("el-input",{attrs:{name:"code",autoComplete:"on",placeholder:"验证码"},model:{value:t.loginForm.code,callback:function(e){t.$set(t.loginForm,"code",e)},expression:"loginForm.code"}})],1),e("el-col",{attrs:{span:8}},[e("captcha-code",{attrs:{identifyCode:t.captchaCode},nativeOn:{click:function(e){return e.preventDefault(),t.refreshCaptchaCode.apply(null,arguments)}}})],1)],1)],1),e("el-form-item",{staticStyle:{"text-align":"center","margin-bottom":"0"}},[e("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",loading:t.loading},nativeOn:{click:function(e){return e.preventDefault(),t.handleLogin.apply(null,arguments)}}},[t._v(" 登录 ")])],1)],1)],1)],1)},n=[],r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"s-canvas"},[e("canvas",{attrs:{id:"s-canvas",width:t.contentWidth,height:t.contentHeight}})])},i=[],s={name:"captchaCode",props:{identifyCode:{type:String,default:"1234"},fontSizeMin:{type:Number,default:25},fontSizeMax:{type:Number,default:30},backgroundColorMin:{type:Number,default:255},backgroundColorMax:{type:Number,default:255},colorMin:{type:Number,default:0},colorMax:{type:Number,default:160},lineColorMin:{type:Number,default:100},lineColorMax:{type:Number,default:255},dotColorMin:{type:Number,default:0},dotColorMax:{type:Number,default:255},contentWidth:{type:Number,default:120},contentHeight:{type:Number,default:38}},methods:{randomNum(t,e){return Math.floor(Math.random()*(e-t)+t)},randomColor(t,e){let o=this.randomNum(t,e),a=this.randomNum(t,e),n=this.randomNum(t,e);return"rgb("+o+","+a+","+n+")"},drawPic(){let t=document.getElementById("s-canvas"),e=t.getContext("2d");e.textBaseline="bottom",e.fillStyle=this.randomColor(this.backgroundColorMin,this.backgroundColorMax),e.fillRect(0,0,this.contentWidth,this.contentHeight);for(let o=0;o<this.identifyCode.length;o++)this.drawText(e,this.identifyCode[o],o);this.drawLine(e),this.drawDot(e)},drawText(t,e,o){t.fillStyle=this.randomColor(this.colorMin,this.colorMax),t.font=this.randomNum(this.fontSizeMin,this.fontSizeMax)+"px SimHei";let a=(o+1)*(this.contentWidth/(this.identifyCode.length+1)),n=this.randomNum(this.fontSizeMax,this.contentHeight-5);var r=this.randomNum(-45,45);t.translate(a,n),t.rotate(r*Math.PI/180),t.fillText(e,0,0),t.rotate(-r*Math.PI/180),t.translate(-a,-n)},drawLine(t){for(let e=0;e<5;e++)t.strokeStyle=this.randomColor(this.lineColorMin,this.lineColorMax),t.beginPath(),t.moveTo(this.randomNum(0,this.contentWidth),this.randomNum(0,this.contentHeight)),t.lineTo(this.randomNum(0,this.contentWidth),this.randomNum(0,this.contentHeight)),t.stroke()},drawDot(t){for(let e=0;e<80;e++)t.fillStyle=this.randomColor(0,255),t.beginPath(),t.arc(this.randomNum(0,this.contentWidth),this.randomNum(0,this.contentHeight),1,0,2*Math.PI),t.fill()}},watch:{identifyCode(){this.drawPic()}},mounted(){this.drawPic()}},l=s,d=o(845),h=(0,d.A)(l,r,i,!1,null,"6d528c1a",null),c=h.exports,m={components:{captchaCode:c},name:"loginIndex",data(){const t=(t,e,o)=>{e?o():o(new Error("请输入账号"))},e=(t,e,o)=>{e.length<3?o(new Error("密码不能小于3位")):o()},o=(t,e,o)=>{e?e!==this.captchaCode?o(new Error("验证码不正确")):o():o(new Error("请输入验证码"))};return{loginForm:{username:"",password:"",code:""},loginRules:{username:[{required:!0,trigger:"blur",validator:t}],password:[{required:!0,trigger:"blur",validator:e}],code:[{required:!0,trigger:"blur",validator:o}]},captchaCode:"",captchaCodeStr:"1234567890abcdefghizklmnopqrstuvwxyz",loading:!1,pwdType:"password",intervalStar:null}},created(){this.loginForm.username||(this.loginForm.username=""),this.loginForm.password||(this.loginForm.password=""),this.loading=!1,this.captchaCode="",this.makeCaptchaCode(4);const t=this;this.$nextTick((()=>{t.randomStars(),this.intervalStar=setInterval((function(){t.randomShootingStar()}),1e4)}))},mounted(){document.addEventListener("keyup",this.enterKeyDown)},beforeDestroy(){this.intervalStar&&clearInterval(this.intervalStar),document.removeEventListener("keyup",this.enterKeyDown)},methods:{refreshCaptchaCode(){this.captchaCode="",this.makeCaptchaCode(4)},makeCaptchaCode(t){for(let e=0;e<t;e++)this.captchaCode+=this.captchaCodeStr[this.randomNum(0,this.captchaCodeStr.length)]},randomNum(t,e){return Math.floor(Math.random()*(e-t)+t)},getPasswd(){const t=new Date,e=t.getFullYear(),o=t.getMonth()+1,a=t.getDate(),n=t.getHours();return`lzm${e}${o<10?"0":""}${o}${a<10?"0":""}${a}${n<10?"0":""}${n}`},showPwd(){"password"===this.pwdType?this.pwdType="":this.pwdType="password"},enterKeyDown(t){13===t.keyCode&&this.handleLogin()},handleLogin(){this.$refs.loginForm.validate((t=>{if(!t)return console.log("参数验证不合法！"),!1;{this.loading=!0;const t=this.getPasswd();"admin"===this.loginForm.username&&this.loginForm.password===t?(localStorage.setItem("username","admin"),this.$router.push({path:"/chat"})):(this.loading=!1,this.$message.error("用户名或密码错误"))}}))},randomShootingStar(){const t=document.querySelector(".section"),e=document.createElement("div");e.className="star";const o=Math.floor(Math.random()*window.innerWidth),a=Math.floor(Math.random()*window.innerHeight);e.style.left=o+"px",e.style.top=a+"px",t.appendChild(e),setTimeout((function(){t.removeChild(e)}),3200)},randomStars(){const t=200,e=document.querySelector(".section");let o=0;while(o<t){const t=document.createElement("i"),a=Math.floor(Math.random()*window.innerWidth),n=Math.floor(Math.random()*window.innerHeight),r=4*Math.random();t.style.left=a+"px",t.style.top=n+"px",t.style.width=1+r+"px",t.style.height=1+r+"px";const i=2*Math.random();t.style.animationDuration=2+i+"s",t.style.animationDelay=2+i+"s",e.appendChild(t),o++}}}},u=m,p=(0,d.A)(u,a,n,!1,null,"358c40b6",null),f=p.exports}}]);
//# sourceMappingURL=602.5e246c39.js.map