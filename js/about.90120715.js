"use strict";(self["webpackChunkmy_chat"]=self["webpackChunkmy_chat"]||[]).push([[594],{6062:function(t,e,o){o.r(e),o.d(e,{default:function(){return h}});var a=function(){var t=this,e=t._self._c;return e("div",[e("div",[e("el-card",{attrs:{"body-style":{padding:"10px"}}},[e("div",{staticStyle:{"text-align":"right"}},[e("el-dropdown",[e("span",{staticClass:"el-dropdown-link"},[e("el-avatar",{attrs:{size:18,src:t.user}}),t._v(" ???（gpt-3.5-turbo） "),e("i",{staticClass:"el-icon-arrow-down el-icon--right"})],1),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e("el-dropdown-item",{nativeOn:{click:function(e){return t.handle2Theme.apply(null,arguments)}}},[e("i",{staticClass:"el-icon-sunrise-1"}),t._v(" 主题 ")]),e("el-dropdown-item",{staticStyle:{color:"red"},nativeOn:{click:function(e){return t.handleLogOut.apply(null,arguments)}}},[e("i",{staticClass:"el-icon-switch-button"}),t._v(" 退出 ")])],1)],1)],1)])],1),t.chatDataList&&t.chatDataList.length>0?e("div",[e("div",{ref:"chatRef",style:{height:t.height+"px",overflowY:"auto"}},t._l(t.chatDataList,(function(o,a){return e("div",{key:a},[a%2===0?e("div",{staticClass:"my_chat"},[e("el-avatar",{attrs:{size:32,src:t.user}}),e("span",{staticStyle:{"margin-left":"20px",width:"50%"}},[t._v(" "+t._s(o.content)+" ")])],1):e("div",{staticClass:"ai_chat"},[e("el-avatar",{attrs:{size:32,src:t.chatGpt}}),e("span",{staticStyle:{"margin-left":"20px",width:"50%"}},[e("v-md-preview",{attrs:{text:o.content}})],1)],1)])})),0)]):e("div",{staticStyle:{"margin-top":"50px"}},[e("el-empty",{attrs:{description:"暂无对话"}})],1),e("div",{staticClass:"send-card"},[e("el-card",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{"body-style":{padding:"0px"}}},[e("el-input",{staticClass:"chat-input",attrs:{autosize:"",maxlength:"36",placeholder:"请输入你的问题"},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}},[e("i",{staticClass:"el-icon-s-promotion el-input__icon",attrs:{slot:"suffix"},on:{click:t.handleSend},slot:"suffix"})])],1)],1)])},n=[],i=o.p+"img/chatgpt.708f3676.png",s=o.p+"img/user.81ef2218.png",r={components:{},name:"chatIndex",data(){return{loading:!1,height:window.innerHeight-180,theme:1,content:"",contentPre:"",chatDataList:[],chatGpt:i,user:s,url:"https://api.chatanywhere.com.cn/v1/chat/completions",apiKey:"sk-Cg8AqAWoQxhqetjTXfdzOeDm5yKu3zUPdmAg9bweMkxIDskj"}},created(){this.chatDataList=[]},mounted(){document.addEventListener("keyup",this.enterKeyDown)},destroyed(){document.removeEventListener("keyup",this.enterKeyDown)},methods:{enterKeyDown(t){13===t.keyCode&&this.handleSend(),38===t.keyCode&&(this.content=this.contentPre)},reachBottom(){const t=this.$refs.chatRef;t&&setTimeout((()=>{t.scrollTop=t.scrollHeight}),0)},handle2Theme(){console.log("123")},handleLogOut(){this.$router.push({path:"/"})},async handleSend(){if(this.loading=!0,!this.content)return this.$message({message:"消息不能为空",type:"warning"}),void(this.loading=!1);const t={role:"user",content:this.content};this.chatDataList.push(t),this.reachBottom();const e={model:"gpt-3.5-turbo",messages:this.chatDataList,stream:!0},o=this,a=await fetch(this.url,{method:"POST",headers:{Authorization:"Bearer "+this.apiKey,"Content-Type":"application/json"},body:JSON.stringify(e)}),n=a.body.pipeThrough(new TextDecoderStream).getReader();let i=!0;do{let{value:t,done:e}=await n.read();if(e&&(i=!1),!t)continue;t=t?.replace("undefined","");const a=t.split("data:");a&&a.length>0&&a.forEach((t=>{if(t&&!t.includes("[DONE]")){let e="";if("\n\n"===t||"\n"===t)e="";else{const o=JSON.parse(t.trim());o.choices[0].delta.content&&(e=o.choices[0].delta.content)}const a=o.chatDataList[o.chatDataList.length-1];if("assistant"===a.role)o.chatDataList[o.chatDataList.length-1].content=a.content+e;else{const t={role:"assistant",content:e};o.chatDataList.push(t)}o.reachBottom()}}))}while(i);o.contentPre=o.content,o.content="",o.loading=!1}}},l=r,d=o(845),c=(0,d.A)(l,a,n,!1,null,"20d34c10",null),h=c.exports},3184:function(t,e,o){o.r(e),o.d(e,{default:function(){return g}});var a=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"loginBg"}},[e("el-card",{staticClass:"login-form-layout"},[e("el-form",{ref:"loginForm",attrs:{autoComplete:"on",model:t.loginForm,rules:t.loginRules,"label-position":"left"}},[e("div",{staticStyle:{display:"flex","margin-bottom":"20px"}},[e("div",[e("div",{staticStyle:{"font-size":"20px","line-height":"26px","font-weight":"600"}},[t._v(" 我的 "),e("i",{staticClass:"el-icon-chat-dot-square"})])])]),e("el-form-item",{staticStyle:{"margin-bottom":"16px"},attrs:{prop:"username"}},[e("el-input",{attrs:{name:"username",type:"text",autoComplete:"on",placeholder:"账号"},model:{value:t.loginForm.username,callback:function(e){t.$set(t.loginForm,"username",e)},expression:"loginForm.username"}},[e("span",{attrs:{slot:"prefix"},slot:"prefix"},[e("i",{staticClass:"el-icon-user",staticStyle:{"margin-left":"5px"}})])])],1),e("el-form-item",{staticStyle:{"margin-bottom":"16px"},attrs:{prop:"password"}},[e("el-input",{attrs:{name:"password",type:t.pwdType,autoComplete:"on",placeholder:"请输入密码"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleLogin.apply(null,arguments)}},model:{value:t.loginForm.password,callback:function(e){t.$set(t.loginForm,"password",e)},expression:"loginForm.password"}},[e("span",{attrs:{slot:"prefix"},slot:"prefix"},[e("i",{staticClass:"el-icon-lock",staticStyle:{"margin-left":"5px"}})]),e("span",{attrs:{slot:"suffix"},on:{click:t.showPwd},slot:"suffix"},[t.pwdType?e("i",{staticClass:"el-icon-thumb"}):e("i",{staticClass:"el-icon-view",staticStyle:{color:"#287dff"}})])])],1),e("el-form-item",{attrs:{prop:"code"}},[e("el-row",{attrs:{gutter:10}},[e("el-col",{attrs:{span:16}},[e("el-input",{attrs:{name:"code",autoComplete:"on",placeholder:"验证码"},model:{value:t.loginForm.code,callback:function(e){t.$set(t.loginForm,"code",e)},expression:"loginForm.code"}})],1),e("el-col",{attrs:{span:8}},[e("captcha-code",{attrs:{identifyCode:t.captchaCode},nativeOn:{click:function(e){return e.preventDefault(),t.refreshCaptchaCode.apply(null,arguments)}}})],1)],1)],1),e("el-form-item",{staticStyle:{"text-align":"center","margin-bottom":"0"}},[e("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",loading:t.loading},nativeOn:{click:function(e){return e.preventDefault(),t.handleLogin.apply(null,arguments)}}},[t._v(" 登录 ")])],1)],1)],1)],1)},n=[],i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"s-canvas"},[e("canvas",{attrs:{id:"s-canvas",width:t.contentWidth,height:t.contentHeight}})])},s=[],r={name:"captchaCode",props:{identifyCode:{type:String,default:"1234"},fontSizeMin:{type:Number,default:25},fontSizeMax:{type:Number,default:30},backgroundColorMin:{type:Number,default:255},backgroundColorMax:{type:Number,default:255},colorMin:{type:Number,default:0},colorMax:{type:Number,default:160},lineColorMin:{type:Number,default:100},lineColorMax:{type:Number,default:255},dotColorMin:{type:Number,default:0},dotColorMax:{type:Number,default:255},contentWidth:{type:Number,default:120},contentHeight:{type:Number,default:38}},methods:{randomNum(t,e){return Math.floor(Math.random()*(e-t)+t)},randomColor(t,e){let o=this.randomNum(t,e),a=this.randomNum(t,e),n=this.randomNum(t,e);return"rgb("+o+","+a+","+n+")"},drawPic(){let t=document.getElementById("s-canvas"),e=t.getContext("2d");e.textBaseline="bottom",e.fillStyle=this.randomColor(this.backgroundColorMin,this.backgroundColorMax),e.fillRect(0,0,this.contentWidth,this.contentHeight);for(let o=0;o<this.identifyCode.length;o++)this.drawText(e,this.identifyCode[o],o);this.drawLine(e),this.drawDot(e)},drawText(t,e,o){t.fillStyle=this.randomColor(this.colorMin,this.colorMax),t.font=this.randomNum(this.fontSizeMin,this.fontSizeMax)+"px SimHei";let a=(o+1)*(this.contentWidth/(this.identifyCode.length+1)),n=this.randomNum(this.fontSizeMax,this.contentHeight-5);var i=this.randomNum(-45,45);t.translate(a,n),t.rotate(i*Math.PI/180),t.fillText(e,0,0),t.rotate(-i*Math.PI/180),t.translate(-a,-n)},drawLine(t){for(let e=0;e<5;e++)t.strokeStyle=this.randomColor(this.lineColorMin,this.lineColorMax),t.beginPath(),t.moveTo(this.randomNum(0,this.contentWidth),this.randomNum(0,this.contentHeight)),t.lineTo(this.randomNum(0,this.contentWidth),this.randomNum(0,this.contentHeight)),t.stroke()},drawDot(t){for(let e=0;e<80;e++)t.fillStyle=this.randomColor(0,255),t.beginPath(),t.arc(this.randomNum(0,this.contentWidth),this.randomNum(0,this.contentHeight),1,0,2*Math.PI),t.fill()}},watch:{identifyCode(){this.drawPic()}},mounted(){this.drawPic()}},l=r,d=o(845),c=(0,d.A)(l,i,s,!1,null,"6d528c1a",null),h=c.exports,u={components:{captchaCode:h},name:"loginIndex",data(){const t=(t,e,o)=>{e?o():o(new Error("请输入账号"))},e=(t,e,o)=>{e.length<3?o(new Error("密码不能小于3位")):o()},o=(t,e,o)=>{e?e!==this.captchaCode?o(new Error("验证码不正确")):o():o(new Error("请输入验证码"))};return{loginForm:{username:"",password:"",code:""},loginRules:{username:[{required:!0,trigger:"blur",validator:t}],password:[{required:!0,trigger:"blur",validator:e}],code:[{required:!0,trigger:"blur",validator:o}]},captchaCode:"",captchaCodeStr:"1234567890abcdefghizklmnopqrstuvwxyz",loading:!1,pwdType:"password",dialogVisible:!1,supportDialogVisible:!1}},created(){this.loginForm.username||(this.loginForm.username=""),this.loginForm.password||(this.loginForm.password="")},mounted(){this.captchaCode="",this.makeCaptchaCode(),document.addEventListener("keyup",this.enterKeyDown)},destroyed(){document.removeEventListener("keyup",this.enterKeyDown)},methods:{refreshCaptchaCode(){this.captchaCode="",this.makeCaptchaCode(4)},makeCaptchaCode(t){for(let e=0;e<t;e++)this.captchaCode+=this.captchaCodeStr[this.randomNum(0,this.captchaCodeStr.length)]},randomNum(t,e){return Math.floor(Math.random()*(e-t)+t)},getPasswd(){const t=new Date,e=t.getFullYear(),o=t.getMonth()+1,a=t.getDate(),n=t.getHours(),i=t.getMinutes();return`lzm${e}${o<10?"0":""}${o}${a<10?"0":""}${a}${n<10?"0":""}${n}${i<10?"0":""}${i}`},showPwd(){"password"===this.pwdType?this.pwdType="":this.pwdType="password"},enterKeyDown(t){13===t.keyCode&&this.handleLogin()},handleLogin(){this.$refs.loginForm.validate((t=>{if(!t)return console.log("参数验证不合法！"),!1;{const t=this.getPasswd();"admin"===this.loginForm.username&&this.loginForm.password===t?this.$router.push({path:"/chat"}):this.$message.error("用户名或密码错误")}}))}}},p=u,m=(0,d.A)(p,a,n,!1,null,"0c07babe",null),g=m.exports}}]);
//# sourceMappingURL=about.90120715.js.map